@isTest
public class FormBuilderControllerTest {
    // @isTest
    // static void testformbuilder(){
    //     Custom_Form_Setting__c cs = TestDataFactory.createGuestFormSettings('EasyformTestGuestForms__c','GuestForms__c','GuestForms__c','EasyForm Layout');
    //     GuestForms__c gf = TestDataFactory.createGuestForm(cs.id);
    //     GuestForms__c guestForm  = [select  Custom_Form_Settings__r.Record_Type__c,UUID__C,First_open_date__c,Custom_Form_Settings__r.Form_Header_Color__c,Custom_Form_Settings__r.Form_body_color__c,Custom_Form_Settings__r.Form_Background_Color__c,Status__c,PageLayout__c,Number_of_opens__c,Object_API_Name__c,PageLayout_name__c,Last_open_date__c,Id,First_submitted_date__c,Number_of_submissions__c,Last_submitted_date__c,Parent__c,Custom_Form_Settings__r.Sobject_Label_Name__c,Custom_Form_Settings__r.Allowed_File_Types__c,Custom_Form_Settings__r.Allow_edit_after_submit__c,Custom_Form_Settings__r.Allow_File_Upload__c,Custom_Form_Settings__r.Allow_read_after_submit__c from guestforms__c
    //                                 where Id=: gf.Id];
    //     Attachment att  = TestDataFactory.createAttachment(cs.Id);
    //     guestForm.Object_API_Name__c = 'GuestForms__c';
    //     guestForm.PageLayout_Name__c = 'EasyForm Layout';
    //     update guestForm;
    //     formBuilderController.getPageLayoutFields(guestForm.UUID__c);
    //     formBuilderController.updateGuestForm(guestForm,cs.Id,att.Id);
    //     Id fileId= formBuilderController.saveTheFile(guestForm.id,'Test','372848327teug','Application/JSON');
    //     formBuilderController.saveChunk(guestForm.id,'Test','372848327teug','Application/JSON',fileId);
    //     formBuilderController.pageLayoutSectionsandFields(guestForm.PageLayout_Name__c,guestForm.Object_API_Name__c);
    // }

    @isTest
    static void createSurveyTest() {
        Survey__c survey = new Survey__c(Name = 'Survey For Profile');
        insert survey;
        FormBuilderController builder = new FormBuilderController();
        builder.recordId = survey.Id;

        PageReference pageRef = Page.FormBuilderVf;
        Test.setCurrentPage(pageRef);
        String jsonstr = '{"title":"Patient Information","logo":"https://cdn-icons-png.flaticon.com/512/2966/2966327.png","logoWidth":"100px","logoHeight":"100px","logoFit":"cover","logoPosition":"right","pages":[{"name":"page1","elements":[{"type":"panel","name":"Patient Name Panel","elements":[{"type":"text","name":"patient-firstname","title":"Patient First Name","hideNumber":true,"isRequired":true},{"type":"text","name":"patient-middlename","startWithNewLine":false,"title":"Patient Middle Name","hideNumber":true},{"type":"text","name":"patient-lastname","startWithNewLine":false,"title":"Patient Last Name","hideNumber":true,"isRequired":true},{"type":"text","name":"patient-preferred-name","startWithNewLine":false,"title":"Patient Preferred Name","hideNumber":true}],"title":"Patient Name"},{"type":"panel","name":"panel1","elements":[{"type":"dropdown","name":"gender","title":"Gender","hideNumber":true,"isRequired":true,"choices":["Male","Female","Other"]},{"type":"text","name":"ssn","startWithNewLine":false,"title":"Social Security Number","hideNumber":true},{"type":"text","name":"patient-dob","startWithNewLine":false,"title":"Date of Birth","hideNumber":true,"validators":[{"type":"expression"}],"inputType":"date","min":"1900-12-12"}]},{"type":"panel","name":"panel2","elements":[{"type":"text","name":"primary-phone","title":"Primary Phone","hideNumber":true,"inputType":"tel"},{"type":"text","name":"cell-phone","startWithNewLine":false,"title":"Cell Phone","hideNumber":true,"inputType":"tel"},{"type":"text","name":"email","startWithNewLine":false,"title":"Email","hideNumber":true,"inputType":"email"}]},{"type":"panel","name":"panel6","elements":[{"type":"text","name":"address","title":"Address","hideNumber":true},{"type":"text","name":"address2","startWithNewLine":false,"title":"Address 2","hideNumber":true},{"type":"text","name":"city","startWithNewLine":false,"title":"City","hideNumber":true},{"type":"text","name":"state","startWithNewLine":false,"title":"State","hideNumber":true},{"type":"text","name":"zip","startWithNewLine":false,"title":"Zip","hideNumber":true}],"title":"Home Address"},{"type":"panel","name":"panel3","elements":[{"type":"text","name":"emergency-contact-firstname","title":"Emergency Contact First Name","hideNumber":true,"isRequired":true},{"type":"text","name":"emergency-contact-lastname","startWithNewLine":false,"title":"Emergency Contact Last Name","hideNumber":true,"isRequired":true},{"type":"text","name":"emergency-contact-phone","startWithNewLine":false,"title":"Emergency Contact Phone","hideNumber":true,"isRequired":true,"inputType":"tel"},{"type":"text","name":"emergency-contact-relationship","startWithNewLine":false,"title":"Emergency Contact Relationship","hideNumber":true,"isRequired":true}]},{"type":"panel","name":"panel4","elements":[{"type":"text","name":"occupation","title":"Occupation","hideNumber":true},{"type":"text","name":"position","startWithNewLine":false,"title":"Position","hideNumber":true},{"type":"dropdown","name":"employment-type","startWithNewLine":false,"title":"Employment Type","hideNumber":true,"choices":["Full-Time","Part-Time"]},{"type":"text","name":"employer-name","title":"Employer Name","hideNumber":true},{"type":"text","name":"work-phone","startWithNewLine":false,"title":"Work Phone","hideNumber":true,"inputType":"tel"}]},{"type":"panel","name":"panel7","elements":[{"type":"text","name":"work-address","title":"Address","hideNumber":true},{"type":"text","name":"work-address2","startWithNewLine":false,"title":"Address 2","hideNumber":true},{"type":"text","name":"work-city","startWithNewLine":false,"title":"City","hideNumber":true},{"type":"text","name":"work-state","startWithNewLine":false,"title":"State","hideNumber":true},{"type":"text","name":"work-zip","startWithNewLine":false,"title":"Zip","hideNumber":true}],"title":"Work Address"},{"type":"panel","name":"panel5","elements":[{"type":"boolean","name":"do-you-have-insurance","title":"Do you have Insurance?","hideNumber":true},{"type":"panel","name":"panel8","elements":[{"type":"dropdown","name":"insurance-policy-holder","title":"Primary Insurance Policy Holder","hideNumber":true,"isRequired":true,"choices":["Self","Spouse","Father","Mother","Family","Other"]},{"type":"text","name":"firstname-primary-insured","startWithNewLine":false,"title":"First Name of Primary Insured","hideNumber":true,"isRequired":true},{"type":"text","name":"lastname-primary-insured","startWithNewLine":false,"title":"Last Name of Primary Insured","hideNumber":true,"isRequired":true},{"type":"text","name":"insurance-id","startWithNewLine":false,"title":"Insurance Id #","hideNumber":true},{"type":"text","name":"insurance-company-name","title":"Insurance Company Name","hideNumber":true},{"type":"text","name":"insurance-group-name","startWithNewLine":false,"title":"Group Name","hideNumber":true},{"type":"text","name":"insurance-group-number","startWithNewLine":false,"title":"Group Number","hideNumber":true},{"type":"text","name":"primary-insured-dob","startWithNewLine":false,"title":"Birthdate of Primary Insured","hideNumber":true,"isRequired":true,"inputType":"date"},{"type":"text","name":"primary-insured-relation-to-patient","title":"Primary Insured Relationship to Patient"},{"type":"file","name":"primary-insurance-document","title":"Insurance Document","isRequired":true,"acceptedTypes":".jpg, .png, .pdf","maxSize":5000000}],"visibleIf":"{do-you-have-insurance} = true"}]},{"type":"panel","name":"panel9","elements":[{"type":"boolean","name":"do-you-have-secondary-insurance","title":"Do you have Secondary Insurance?","hideNumber":true},{"type":"panel","name":"panel10","elements":[{"type":"dropdown","name":"secondary-insurance-policy-holder","title":"Secondary Insurance Policy Holder","hideNumber":true,"isRequired":true,"choices":["Self","Spouse","Father","Mother","Family","Other"]},{"type":"text","name":"firstname-secondary-insured","startWithNewLine":false,"title":"First Name of Secondary Insured","hideNumber":true,"isRequired":true},{"type":"text","name":"lastname-secondary-insured","startWithNewLine":false,"title":"Last Name of Secondary Insured","hideNumber":true,"isRequired":true},{"type":"text","name":"secondary-insurance-Id","startWithNewLine":false,"title":"Insurance Id #","hideNumber":true},{"type":"text","name":"secondary-insurance-companyname","title":"Insurance Company Name","hideNumber":true},{"type":"text","name":"secondary-group-name","startWithNewLine":false,"title":"Group Name","hideNumber":true},{"type":"text","name":"secondary-group-number","startWithNewLine":false,"title":"Group Number","hideNumber":true},{"type":"text","name":"secondary-insured-dob","startWithNewLine":false,"title":"Birthdate of Secondary Insured","hideNumber":true,"isRequired":true,"inputType":"date"},{"type":"text","name":"secondary-insured-relation-to-patient","title":"Secondary Insured Relationship to Patient"},{"type":"file","name":"secondary-indurance-document","title":"Insurance Document","isRequired":true,"acceptedTypes":".jpg, .png, .pdf","maxSize":5000000}],"visibleIf":"{do-you-have-secondary-insurance} = true"}]}]}],"completeText":"Submit"}';
        ApexPages.currentPage().getParameters().put('formMetadata', jsonstr);
        ApexPages.currentPage().getParameters().put('survey', survey.Id);

        builder.updateSurveyRecord();
        builder.expand();
        builder.getJson();
    }
    
}